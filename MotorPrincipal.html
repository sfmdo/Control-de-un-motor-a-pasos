<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Motor a Pasos</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome (para iconos) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="static/css/Motor.css">
</head>
<body>
    <div class="container-fluid min-vh-100 d-flex flex-column p-4">
        <header class="text-center mb-4">
            <h1 class="text-light-green display-4">Control de Motor a Pasos <i class="fas fa-microchip ms-3"></i></h1>
        </header>

        <main class="flex-grow-1 d-flex flex-column">
            <!-- Sección de Estado General -->
            <div class="card bg-dark-card text-light mb-4 shadow-lg border-primary">
                <div class="card-header bg-dark-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0 text-white"><i class="fas fa-info-circle me-2"></i> Estado del Motor</h5>
                    <button id="refreshStatusBtn" class="btn btn-outline-primary btn-sm"><i class="fas fa-sync-alt me-2"></i> Actualizar Valores</button>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-md-3">
                            <p class="mb-0"><strong class="text-success">Conexión:</strong> <span id="connectionStatus" class="badge bg-danger">Desconectado</span></p>
                        </div>
                        <div class="col-md-3">
                            <p class="mb-0"><strong class="text-warning">Pasos Actuales:</strong> <span id="currentSteps">0</span></p>
                        </div>
                        <div class="col-md-3">
                            <p class="mb-0"><strong class="text-info">Dirección:</strong> <span id="motorDirection">Nula</span></p>
                        </div>
                        <div class="col-md-3">
                            <p class="mb-0"><strong class="text-secondary">Modo Pasos:</strong> <span id="stepMode">Medios Pasos</span></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row flex-grow-1">
                <!-- Columna de Control Principal (Encendido, Velocidad, Dirección) -->
                <div class="col-md-6 d-flex flex-column">
                    <div class="card bg-dark-card text-light mb-4 shadow-lg border-primary flex-grow-1">
                        <div class="card-header bg-dark-header">
                            <h5 class="mb-0 text-white"><i class="fas fa-cogs me-2"></i> Control Principal</h5>
                        </div>
                        <div class="card-body d-flex flex-column align-items-center justify-content-around">
                            <!-- Botones de Encendido/Apagado -->
                            <div class="d-flex align-items-center mb-4">
                                <button id="motorOnBtn" class="btn btn-success btn-lg motor-control-btn me-3"><i class="fas fa-power-off me-2"></i> Encender</button>
                                <button id="motorOffBtn" class="btn btn-danger btn-lg motor-control-btn me-3"><i class="fas fa-stop-circle me-2"></i> Apagar</button>
                                <div id="powerIndicator" class="power-indicator off"></div>
                            </div>

                            <!-- Visualización del Motor -->
                            <div class="motor-animation-container mb-4">
                                <img id="motorAnimation" src="motor_static.png" alt="Motor" class="img-fluid motor-image">
                                <img id="directionArrow" src="arrow_up.png" alt="Flecha de Dirección" class="direction-arrow">
                            </div>

                            <!-- Knob para Velocidad y Dirección -->
                            <div class="knob-and-info-container mb-4"> <!-- Nuevo contenedor -->
                                <div id="speedDirectionKnob" class="knob">
                                    <div class="knob-marker"></div>
                                </div>
                                <div class="knob-info mt-3 text-center"> <!-- Margen superior ajustado -->
                                    <span class="d-block">Velocidad: <span id="knobSpeedValue">0%</span></span>
                                    <span class="d-block">Dirección: <span id="knobDirectionValue">0°</span></span>
                                </div>
                                <button id="sendKnobDataBtn" class="btn btn-primary mt-3 btn-lg"><i class="fas fa-paper-plane me-2"></i> Enviar Velocidad/Dirección</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Columna de Modos y Acciones Especiales -->
                <div class="col-md-6 d-flex flex-column">
                    <!-- Modo de Pasos -->
                    <div class="card bg-dark-card text-light mb-4 shadow-lg border-primary">
                        <div class="card-header bg-dark-header">
                            <h5 class="mb-0 text-white"><i class="fas fa-ruler-combined me-2"></i> Modo de Pasos</h5>
                        </div>
                        <div class="card-body text-center">
                            <button id="halfStepModeBtn" class="btn btn-secondary btn-lg me-3 mode-btn active"><i class="fas fa-step-forward me-2"></i> Medios Pasos</button>
                            <button id="fullStepModeBtn" class="btn btn-secondary btn-lg mode-btn"><i class="fas fa-step-backward me-2"></i> Pasos Completos</button>
                        </div>
                    </div>

                    <!-- Control por Ángulo/Vueltas y Funciones Extras -->
                    <div class="card bg-dark-card text-light flex-grow-1 shadow-lg border-primary">
                        <div class="card-header bg-dark-header">
                            <h5 class="mb-0 text-white"><i class="fas fa-sliders-h me-2"></i> Acciones Específicas</h5>
                        </div>
                        <div class="card-body d-flex flex-column justify-content-around">
                            <!-- Sección de Giro por Ángulo -->
                            <div class="mb-4">
                                <label for="angleInput" class="form-label"><i class="fas fa-angle-right me-2"></i> Girar por Ángulo (0-360°):</label>
                                <input type="number" id="angleInput" class="form-control bg-dark text-light border-secondary mb-2" min="0" max="360" value="0">
                                <button id="rotateByAngleBtn" class="btn btn-warning btn-lg w-100"><i class="fas fa-redo-alt me-2"></i> Girar Ángulo</button>
                            </div>

                            <!-- Botones de Vueltas Predefinidas -->
                            <div class="d-flex justify-content-around mb-4">
                                <button id="fullRevolutionBtn" class="btn btn-info btn-lg flex-fill me-2 action-btn"><i class="fas fa-sync me-2"></i> 1 Vuelta Completa</button>
                                <button id="halfRevolutionBtn" class="btn btn-info btn-lg flex-fill action-btn"><i class="fas fa-undo-alt me-2"></i> Media Vuelta</button>
                            </div>

                            <!-- Funciones Extras -->
                            <div class="text-center">
                                <h6 class="text-light-green mb-3"><i class="fas fa-star me-2"></i> Funciones Extras</h6>
                                <div class="d-grid gap-2">
                                    <button id="oscillateBtn" class="btn btn-outline-light action-btn"><i class="fas fa-arrows-alt-h me-2"></i> Oscilar (90° Adelante/Atrás)</button>
                                    <button id="toggleTorqueBtn" class="btn btn-outline-light action-btn"><i class="fas fa-hand-rock me-2"></i> Toggle Torque</button>
                                    <button id="returnToZeroBtn" class="btn btn-outline-light action-btn"><i class="fas fa-home me-2"></i> Volver a Cero</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <footer class="text-center text-light-green mt-4">
            <p>&copy; 2024 Control de Motor a Pasos. Desarrollado por el pepe y ete sech</p>
        </footer>
    </div>

    <!-- Bootstrap JS y Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <!-- Script personalizado -->
    <script src="static/js/Motor.js"></script>
</body>
</html>